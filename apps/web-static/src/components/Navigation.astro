---
// Get current path for active link styling
const currentPath = Astro.url.pathname;

// Environment-aware URL configuration
const isDev = import.meta.env.DEV;

// In development, backend routes are proxied by Vite to localhost:8080
// In production, backend routes are proxied by Cloudflare Pages via _redirects
const authItems = [
  { href: '/login', label: 'Login', class: 'btn btn-outline' },
  { href: '/register', label: 'Register', class: 'btn btn-primary' },
  { href: '/dashboard', label: 'Dashboard', class: 'btn btn-secondary' },
];

// Sandbox URL: in development it's a separate server, in production it's served statically
const getSandboxURL = () => isDev ? 'http://localhost:5173' : '/sandbox';

const navItems = [
  { href: '/', label: 'Home' },
  { href: '/about/', label: 'About' },
  { href: '/rules/', label: 'Rules' },
  { href: '/timeline/', label: 'Timeline' },
  { href: '/sponsors/', label: 'Sponsors' },
  { href: '/faq/', label: 'FAQ' },
  { href: getSandboxURL(), label: 'Play Games' },
];
---

<header class="header">
  <div class="container">
    <div class="header-content">
      <a href="/" class="text-2xl font-bold text-primary logo-link">
        <span class="logo-text">Compify</span>
      </a>
      
      <nav class="nav nav-horizontal hidden md:flex">
        {navItems.map(({ href, label }) => (
          <a 
            href={href} 
            class={`nav-link ${currentPath === href ? 'active' : ''}`}
            aria-current={currentPath === href ? 'page' : undefined}
          >
            {label}
          </a>
        ))}
      </nav>
      
      <div class="flex items-center gap-3 hidden md:flex">
        {authItems.map(({ href, label, class: className }) => (
          <a href={href} class={className}>
            {label}
          </a>
        ))}
      </div>
      
      <!-- Mobile menu button -->
      <button class="md:hidden btn btn-ghost" aria-label="Toggle navigation menu" id="mobile-menu-btn">
        <span class="block w-6 h-0.5 bg-current mb-1"></span>
        <span class="block w-6 h-0.5 bg-current mb-1"></span>
        <span class="block w-6 h-0.5 bg-current"></span>
      </button>
    </div>
    
    <!-- Mobile menu -->
    <div class="md:hidden hidden" id="mobile-menu">
      <nav class="nav nav-vertical py-4 border-t border-gray-200">
        {navItems.map(({ href, label }) => (
          <a 
            href={href} 
            class={`nav-link ${currentPath === href ? 'active' : ''}`}
            aria-current={currentPath === href ? 'page' : undefined}
          >
            {label}
          </a>
        ))}
        <div class="divider my-4"></div>
        {authItems.map(({ href, label, class: className }) => (
          <a href={href} class={`${className} mb-2`}>
            {label}
          </a>
        ))}
      </nav>
    </div>
  </div>
</header>

<script>
  // Simple mobile menu toggle using design system classes
  document.addEventListener('DOMContentLoaded', () => {
    const mobileMenuBtn = document.getElementById('mobile-menu-btn');
    const mobileMenu = document.getElementById('mobile-menu');
    
    if (mobileMenuBtn && mobileMenu) {
      mobileMenuBtn.addEventListener('click', () => {
        mobileMenu.classList.toggle('hidden');
      });
    }
  });
</script>

<style>
  /* Logo styling */
  .logo-link {
    text-decoration: none !important;
  }
  
  .logo-link:hover {
    text-decoration: none !important;
  }
  
  .logo-text {
    background: linear-gradient(135deg, #1e40af, #3b82f6);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    color: #1e40af; /* fallback for browsers that don't support background-clip */
  }
</style>